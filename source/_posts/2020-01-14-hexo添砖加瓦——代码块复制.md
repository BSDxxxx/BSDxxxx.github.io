---
title: hexo添砖加瓦——代码块复制
tags:
  - hexo
categories:
  - 博客管理
message: '您好, 这里需要密码.'
comment: true
copyright: true
sitemap: true
date: 2020-01-14 21:25:28
top:
photos:
password:
hide:
---

参考博文：[https://yfzhou.coding.me/2018/08/27/Hexo-Next搭建个人博客（代码块复制功能）/](https://yfzhou.coding.me/2018/08/27/Hexo-Next搭建个人博客（代码块复制功能）/)

<!--more-->

> 阅读此文前建议先查看{% post_link 本博客信息 %}

# 实现步骤

---

所用工具：[clipboard.js](https://clipboardjs.com)

1. 下载[clipboard.min.js](https://raw.githubusercontent.com/zenorocha/clipboard.js/master/dist/clipboard.min.js)并保存至```themes\next\source\js\clipboard.min.js```

2. 在```.\themes\next\source\js\```下创建```clipboard-use.js```,添加如下内容：

```javascript
/*页面载入完成后，创建复制按钮*/
!function (e, t, a) { 
  var initCopyCode = function(){
    var copyHtml = '';
    copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
    //fa fa-globe可以去字体库替换自己想要的图标
    copyHtml += '  <i class="fa fa-clipboard"></i><span>copy</span>';
    copyHtml += '</button>';
    $(".highlight .code pre").before(copyHtml);
    new ClipboardJS('.btn-copy', {
        target: function(trigger) {
            return trigger.nextElementSibling;
        }
    });
  }
  initCopyCode();
}(window, document);
```

3. 在```根目录\source\_data\```下创建```styles.styl```，添加如下内容：

```css
// 代码块复制按钮
// --------------------------------------------------
.highlight{
  //方便copy代码按钮（btn-copy）的定位
  position: relative;
}
.btn-copy {
    display: inline-block;
    cursor: pointer;
    background-color: #eee;
    background-image: linear-gradient(#fcfcfc,#eee);
    border: 1px solid #d5d5d5;
    border-radius: 3px;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    -webkit-appearance: none;
    font-size: 13px;
    font-weight: 700;
    line-height: 20px;
    color: #333;
    -webkit-transition: opacity .3s ease-in-out;
    -o-transition: opacity .3s ease-in-out;
    transition: opacity .3s ease-in-out;
    padding: 2px 6px;
    position: absolute;
    right: 5px;
    top: 5px;
    opacity: 0;
}
.btn-copy span {
    margin-left: 5px;
}
.highlight:hover .btn-copy{
  opacity: 1;
}
```

4.在```source\_data\```下创建```body-end.swig```，添加如下内容：

```html
<!-- 代码块复制功能 -->
<script type="text/javascript" src="/js/src/clipboard.min.js"></script>  
<script type="text/javascript" src="/js/src/clipboard-use.js"></script>
```

5. 在next配置文件中启用```styles.styl```和```body-end.swig```：

```yml
custom_file_path:
  bodyEnd: source/_data/body-end.swig
  style: source/_data/styles.styl
```